LETTERS[1:4]
p<-c(0.1, 0.2, 0.65, 0.05)
set.seed(666)
n<-c(10,100,30,50)
LETTERS[1:4]
n<-10000
sample(LETTERS[1:4],n,replace = TRUE,prob = c(0.1,0.2,0.65,0.05))
prop.table(table(X))
LETTERS[1:4]
n<-10000
X<-sample(LETTERS[1:4],n,replace = TRUE,prob = c(0.1,0.2,0.65,0.05))
prop.table(table(X))
LETTERS[1:4]
n<-10
X<-sample(LETTERS[1:4],n,replace = TRUE,prob = c(0.1,0.2,0.65,0.05))
prop.table(table(X))
rmultinom(n,4,prob = c(0.1,0.2,0.65,0.05))
LETTERS[1:4]
n<-10
X<-sample(LETTERS[1:4],n,replace = TRUE,prob = c(0.1,0.2,0.65,0.05))
prop.table(table(X))
rmultinom(n=1,N=n,prob = c(0.1,0.2,0.65,0.05))
LETTERS[1:4]
n<-100
X<-sample(LETTERS[1:4],n,replace = TRUE,prob = c(0.1,0.2,0.65,0.05))
prop.table(table(X))
rmultinom(n=1,N=n,prob = c(0.1,0.2,0.65,0.05))
LETTERS[1:4]
n<-100
X<-sample(LETTERS[1:4],n,replace = TRUE,prob = c(0.1,0.2,0.65,0.05))
prop.table(table(X))
rmultinom(n=1,size=n,prob = c(0.1,0.2,0.65,0.05))
#LETTERS[1:4]
n<-100
#X<-sample(LETTERS[1:4],n,replace = TRUE,prob = c(0.1,0.2,0.65,0.05))
#prop.table(table(X))
rmultinom(n=1,size=n,prob = c(0.1,0.2,0.65,0.05))
#LETTERS[1:4]
n<-100
#X<-sample(LETTERS[1:4],n,replace = TRUE,prob = c(0.1,0.2,0.65,0.05))
#prop.table(table(X))
rmultinom(n=1,size=n,prob = c(0.1,0.2,0.65,0.05))
LETTERS[1:4]
n<-100
X<-sample(LETTERS[1:4],n,replace = TRUE,prob = c(0.1,0.2,0.65,0.05))
prop.table(table(X))
X.rmultinom<-rmultinom(n=1,size=n,prob = c(0.1,0.2,0.65,0.05))
p1C <- dmultinom(x,prob=p)
p<-c(0.1, 0.2, 0.65, 0.05)
x<-c(0,0,1,0)
p1C <- dmultinom(x,prob=p)
p<-c(0.1, 0.2, 0.65, 0.05)
x<-c(0,0,1,0)
y<-c(0,0,2,0)
p1C <- dmultinom(x,prob=p)
p2C <- dmultinom(y,prob=p)
p2C
p<-c(0.1, 0.2, 0.65, 0.05)
x<-c(0,0,1,0)
y<-c(0,0,2,0)
z<-c(1,1,1,1)
p1C <- dmultinom(x,prob=p)
p2C <- dmultinom(y,prob=p)
p2C <- dmultinom(z,prob=p)
p2C
prod(p)
4*prod(p)
set.seed(666)
n<-c(10,100,30,50)
X.rmultinom<-rmultinom(n=1,size=100,prob = n)
X.rmultinom
set.seed(666)
n<-c(10,100,30,50)
X.rmultinom<-rmultinom(n=1,size=100,prob = n)
X.table <- matrix(X.rmultinom,nrow = 2,byrow=F)
X.table
set.seed(666)
n<-c(10,100,30,50)
X.rmultinom<-rmultinom(n=1,size=100,prob = n)
X.table <- matrix(X.rmultinom,nrow = 2,byrow=F,dimnames = list('A'=c('on','off'),'B'=c('up','down')))
X.table
set.seed(666)
n<-c(10,100,30,50)
X.rmultinom<-rmultinom(n=1,size=190,prob = n)
X.table <- matrix(X.rmultinom,nrow = 2,byrow=F,dimnames = list('A'=c('on','off'),'B'=c('up','down')))
X.table
prop.table(X.table)
survey <- read.table("survey.txt", header = TRUE)
names(survey)
set.seed(666)
n<-c(10,100,30,50)
p<-n/sum(n)
X.rmultinom<-rmultinom(n=1,size=190,prob = n)
X.table <- matrix(X.rmultinom,nrow = 2,byrow=F,dimnames = list('A'=c('on','off'),'B'=c('up','down')))
prop.table(X.table)
prop.test(x=X.multinom,n=rep(190,4),p=p)
set.seed(666)
n<-c(10,100,30,50)
p<-n/sum(n)
X.rmultinom<-rmultinom(n=1,size=190,prob = n)
X.table <- matrix(X.rmultinom,nrow = 2,byrow=F,dimnames = list('A'=c('on','off'),'B'=c('up','down')))
prop.table(X.table)
prop.test(x=X.rmultinom,n=rep(190,4),p=p)
set.seed(666)
n<-c(10,100,30,50)
p<-n/sum(n)
X.rmultinom<-rmultinom(n=1,size=190,prob = n)
X.table <- matrix(X.rmultinom,nrow = 2,byrow=F,dimnames = list('A'=c('on','off'),'B'=c('up','down')))
prop.table(X.table)
prop.test(x=X.table,n=rep(190,4),p=p)
set.seed(666)
n<-c(10,100,30,50)
p<-n/sum(n)
X.rmultinom<-rmultinom(n=1,size=190,prob = n)
X.table <- matrix(X.rmultinom,nrow = 2,byrow=F,dimnames = list('A'=c('on','off'),'B'=c('up','down')))
prop.table(X.table)
prop.test(x=as.vector(X.table),n=rep(190,4),p=p)
set.seed(666)
n<-c(10,100,30,50)
p<-n/sum(n)
X.rmultinom<-rmultinom(n=1,size=190,prob = n)
X.table <- matrix(X.rmultinom,nrow = 2,byrow=F,dimnames = list('A'=c('on','off'),'B'=c('up','down')))
prop.table(X.table)
prop.test(x=as.vector(X.rmultinom),n=rep(190,4),p=p)
as.vector(X.rmultinom)
prop.test(x=as.vector(X.rmultinom),n=rep(190,4),p=p)
survey <- read.table("survey.txt", header = TRUE)
names(survey)
POE <- prop.table(table(survey$O,survey$E))
POE
View(survey)
survey <- read.table("survey.txt", header = TRUE)
names(survey)
NOE <- xtabs(~E+O,data=survey)
NOE
survey <- read.table("survey.txt", header = TRUE)
names(survey)
NOE <- xtabs(~E+O,data=survey)
POE <- prop.table(NOE)
POE
POE
survey <- read.table("survey.txt", header = TRUE)
names(survey)
NOE <- xtabs(~E+O,data=survey)
POE <- prop.table(NOE) # estimacion por maxima verosimilitud de la distribucion conjunta
PO_E <- prop.table(NOE,margin=1)
PO_E
survey <- read.table("survey.txt", header = TRUE)
names(survey)
NOE <- xtabs(~E+O,data=survey)
POE <- prop.table(NOE) # estimacion por maxima verosimilitud de la distribucion conjunta
PO_E <- prop.table(NOE,margin=1) # margin en prop table indica la variable que condiciona
#In a study of lizard behaviour, characteristics of 409 lizards were recorded, namely species (S), perch diameter (D) and perch height (H).
library(gRain)
data(lizardRAW)
#library(bnlearn)
summary(lizardRAW)
names(lizardRAW)<-c("D","H","S")
NDHS <- xtabs(~D+H+S,data=lizardRAW)
#In a study of lizard behaviour, characteristics of 409 lizards were recorded, namely species (S), perch diameter (D) and perch height (H).
library(gRain)
data(lizardRAW)
#library(bnlearn)
summary(lizardRAW)
names(lizardRAW)<-c("D","H","S")
NDHS <- xtabs(~D+H+S,data=lizardRAW)
PDHS <- prop.table(NDHS)
PDHS
ftable(PDHS)
LETTERS[1:4]
n<-100
X<-sample(LETTERS[1:4],n,replace = TRUE,prob = c(0.1,0.2,0.65,0.05))
prop.table(table(X))
X.rmultinom<-rmultinom(n=1,size=n,prob = c(0.1,0.2,0.65,0.05))
p<-c(0.1, 0.2, 0.65, 0.05)
x<-c(0,0,1,0)
y<-c(0,0,2,0)
z<-c(1,1,1,1)
p1C <- dmultinom(x,prob=p)
p2C <- dmultinom(y,prob=p)
p2C <- dmultinom(z,prob=p)
set.seed(666)
n<-c(10,100,30,50)
p<-n/sum(n)
X.rmultinom<-rmultinom(n=1,size=190,prob = n)
X.table <- matrix(X.rmultinom,nrow = 2,byrow=F,dimnames = list('A'=c('on','off'),'B'=c('up','down')))
prop.table(X.table)
prop.test(x=as.vector(X.rmultinom),n=rep(190,4),p=p)
survey <- read.table("survey.txt", header = TRUE)
names(survey)
NOE <- xtabs(~E+O,data=survey)
# P(O,E)
POE <- prop.table(NOE) # estimacion por maxima verosimilitud de la distribucion conjunta
PO_E <- prop.table(NOE,margin=1) # margin en prop table indica la variable que condiciona
#In a study of lizard behaviour, characteristics of 409 lizards were recorded, namely species (S), perch diameter (D) and perch height (H).
library(gRain)
data(lizardRAW)
#library(bnlearn)
summary(lizardRAW)
names(lizardRAW)<-c("D","H","S")
NDHS <- xtabs(~D+H+S,data=lizardRAW)
PDHS <- prop.table(NDHS)
ftable(PDHS)
PHS<-margin.table(PDHS,margin=c(2,3))
margin.table(PDHS,margin=c(2,3))
PHS.data <- prop.table(xtabs(survey))
PHS.data <- prop.table(xtabs(~H+S,data=survey))
PHS.data <- prop.table(xtabs(~H+S,data=lizard))
PHS.data <- prop.table(xtabs(~H+S,data=lizardRAW
prop.table(xtabs(~H+S,data=lizardRAW
prop.table(xtabs(~H+S,data=lizardRAW)
PHS.data <- prop.table(xtabs(~H+S,data=lizardRAW))
PHS<-margin.table(PDHS,margin=c(2,3))
PHS.data <- prop.table(xtabs(~ H+S,data=lizardRAW))
prop.table(xtabs(~ H+S,data=lizardRAW))
install.packages("bnlearn")
dag <- empty.graph(nodes=c("A", "S", "E", "O", "R", "T"))
library(bnlearn)
dag <- empty.graph(nodes=c("A", "S", "E", "O", "R", "T"))
plot(dag)
set.arc(x=dag,from=A,to=E)
set.arc(x=dag,from='A',to='E')
#solucion
plot(dag)
set.arc(x=dag,from='A',to='E')
#solucion
plot(dag)
dag <- set.arc(x=dag,from='A',to='E')
dag <- set.arc(x=dag,from='S',to='E')
dag <- set.arc(x=dag,from='E',to='O')
dag <- set.arc(x=dag,from='E',to='R')
dag <- set.arc(x=dag,from='O',to='T')
dag <- set.arc(x=dag,from='R',to='T')
#solucion
plot(dag)
dag <- set.arc(x=dag,from='A',to='E')
dag <- set.arc(x=dag,from='S',to='E')
dag <- set.arc(x=dag,from='E',to='O')
dag <- set.arc(x=dag,from='E',to='R')
dag <- set.arc(x=dag,from='O',to='T')
dag <- set.arc(x=dag,from='R',to='T')
#solucion
library(Rgraphviz)
graphiz.plot(dag,layout='dot')
graphviz.plot(dag,layout='dot')
dag <- set.arc(x=dag,from='A',to='E')
dag <- set.arc(x=dag,from='S',to='E')
dag <- set.arc(x=dag,from='E',to='O')
dag <- set.arc(x=dag,from='E',to='R')
dag <- set.arc(x=dag,from='O',to='T')
dag <- set.arc(x=dag,from='R',to='T')
#solucion
library(Rgraphviz)
graphviz.plot(dag,layout='dot')
A.lv <- c("young", "adult", "old")
A.prob <- array(c(0.30, 0.50, 0.20), dim = 3,dimnames = list(A = A.lv))
A.prob
S.lv <- c("M", "F")
S.prob <- array(c(0.6,0.4), dim = 2,dimnames = list(S = S.lv))
S.prob
E.lv <- c("high", "uni")
#P(E|A,S) # dim <- #dim(E)=2, dim(A)=3, dim(S)=2
E.prob <- array(c(0.75, 0.25, 0.72, 0.28, 0.88, 0.12, 0.64,
0.36, 0.70, 0.30, 0.90, 0.10), dim = c(2, 3, 2),
dimnames = list(E = E.lv, A = A.lv, S = S.lv))
E.prob
ftable(E.prob)
E.lv <- c("high", "uni")
#P(E|A,S) # dim <- #dim(E)=2, dim(A)=3, dim(S)=2
E.prob <- array(c(0.75, 0.25, 0.72, 0.28, 0.88, 0.12, 0.64,
0.36, 0.70, 0.30, 0.90, 0.10), dim = c(2, 3, 2),
dimnames = list(E = E.lv, A = A.lv, S = S.lv))
E.prob
ftable(E.prob)
E.lv <- c("high", "uni")
#P(E|A,S) # dim <- #dim(E)=2, dim(A)=3, dim(S)=2
E.prob <- array(c(0.75, 0.25, 0.72, 0.28, 0.88, 0.12, 0.64,
0.36, 0.70, 0.30, 0.90, 0.10), dim = c(2, 3, 2),
dimnames = list(E = E.lv, A = A.lv, S = S.lv))
E.prob
ftable(E.prob,row.vars = c(2,3),col.vars = 1)
E.lv <- c("high", "uni")
#P(E|A,S) # dim <- #dim(E)=2, dim(A)=3, dim(S)=2
E.prob <- array(c(0.75, 0.25, 0.72, 0.28, 0.88, 0.12, 0.64,
0.36, 0.70, 0.30, 0.90, 0.10), dim = c(2, 3, 2),
dimnames = list(E = E.lv, A = A.lv, S = S.lv))
E.prob
ftable(E.prob,row.vars = c(3,2),col.vars = 1)
E.lv <- c("high", "uni")
#P(E|A,S) # dim <- #dim(E)=2, dim(A)=3, dim(S)=2
E.prob <- array(c(0.75, 0.25, 0.72, 0.28, 0.88, 0.12, 0.64,
0.36, 0.70, 0.30, 0.90, 0.10), dim = c(2, 3, 2),
dimnames = list(E = E.lv, A = A.lv, S = S.lv))
E.prob
ftable(E.prob,row.vars = c(3,2),col.vars = 1)
#E.prob
ftable(E.prob,row.vars = c(3,2),col.vars = 1)
O.lv <- c("emp", "shelf")
O.prob <- array(c(0.96,0.4,0.92,0.08), dim = c(2,2),dimnames = list(O = O.lv,E=E.lv))
O.prob
ftable(O.prob,col.vars=1)
R.lv <- c("small", "big")
R.prob <- array(c(0.25,0.75,0.2,0.8), dim = c(2,2),dimnames = list(R = R.lv,E=E.lv))
R.prob
R.lv <- c("small", "big")
R.prob <- array(c(0.25,0.75,0.2,0.8), dim = c(2,2),dimnames = list(R = R.lv,E=E.lv))
R.prob
R.lv <- c("small", "big")
R.prob <- array(c(0.25,0.75,0.2,0.8), dim = c(2,2),dimnames = list(R = R.lv,E=E.lv))
R.prob
T.lv <- c("car", "train", "other")
T.prob <- array(c(0.48, 0.42, 0.10, 0.56, 0.36, 0.08, 0.58,
0.24, 0.18, 0.70, 0.21, 0.09), dim = c(3, 2, 2),
dimnames = list(T = T.lv, O = O.lv, R = R.lv))
T.prob
ftable(T.prob)
cpt  <- list(A=A.prob,S=S.prob,E=E.prob,O=O.prob,R=R.prob,T=T.prop)
cpt  <- list(A=A.prob,S=S.prob,E=E.prob,O=O.prob,R=R.prob,T=T.prob)
bn <- custom.fit(dag,cpt)
bn <- custom.fit(dag,cpt)
bn
bn <- custom.fit(dag,cpt)
T.lv <- c("car", "train", "other")
T.prob <- array(c(0.48, 0.42, 0.10, 0.56, 0.36, 0.08, 0.58,
0.24, 0.18, 0.70, 0.21, 0.09), dim = c(3, 2, 2),
dimnames = list(T = T.lv, O = O.lv, R = R.lv))
ftable(T.prob)
T.lv <- c("car", "train", "other")
T.prob <- array(c(0.48, 0.42, 0.10, 0.56, 0.36, 0.08, 0.58,
0.24, 0.18, 0.70, 0.21, 0.09), dim = c(3, 2, 2),
dimnames = list(T = T.lv, O = O.lv, R = R.lv))
ftable(T.prob,row.vars = c(3,2),col.vars = 1)
O.lv <- c("emp", "shelf")
O.prob <- array(c(0.96,0.04,0.92,0.08), dim = c(2,2),dimnames = list(O = O.lv,E=E.lv))
ftable(O.prob,col.vars=1)
bn <- custom.fit(dag,cpt)
LETTERS[1:4]
n<-100
X<-sample(LETTERS[1:4],n,replace = TRUE,prob = c(0.1,0.2,0.65,0.05))
prop.table(table(X))
X.rmultinom<-rmultinom(n=1,size=n,prob = c(0.1,0.2,0.65,0.05))
p<-c(0.1, 0.2, 0.65, 0.05)
x<-c(0,0,1,0)
y<-c(0,0,2,0)
z<-c(1,1,1,1)
p1C <- dmultinom(x,prob=p)
p2C <- dmultinom(y,prob=p)
p2C <- dmultinom(z,prob=p)
set.seed(666)
n<-c(10,100,30,50)
p<-n/sum(n)
X.rmultinom<-rmultinom(n=1,size=190,prob = n)
X.table <- matrix(X.rmultinom,nrow = 2,byrow=F,dimnames = list('A'=c('on','off'),'B'=c('up','down')))
prop.table(X.table)
prop.test(x=as.vector(X.rmultinom),n=rep(190,4),p=p)
survey <- read.table("survey.txt", header = TRUE)
names(survey)
NOE <- xtabs(~E+O,data=survey)
# P(O,E)
POE <- prop.table(NOE) # estimacion por maxima verosimilitud de la distribucion conjunta
PO_E <- prop.table(NOE,margin=1) # margin en prop table indica la variable que condiciona
#In a study of lizard behaviour, characteristics of 409 lizards were recorded, namely species (S), perch diameter (D) and perch height (H).
library(gRain)
data(lizardRAW)
#library(bnlearn)
summary(lizardRAW)
names(lizardRAW)<-c("D","H","S")
NDHS <- xtabs(~D+H+S,data=lizardRAW)
PDHS <- prop.table(NDHS)
ftable(PDHS)
PHS<-margin.table(PDHS,margin=c(2,3))
PHS.data <- prop.table(xtabs(~ H+S,data=lizardRAW))
library(bnlearn)
dag <- empty.graph(nodes=c("A", "S", "E", "O", "R", "T"))
plot(dag)
dag <- set.arc(x=dag,from='A',to='E')
dag <- set.arc(x=dag,from='S',to='E')
dag <- set.arc(x=dag,from='E',to='O')
dag <- set.arc(x=dag,from='E',to='R')
dag <- set.arc(x=dag,from='O',to='T')
dag <- set.arc(x=dag,from='R',to='T')
#solucion
library(Rgraphviz)
graphviz.plot(dag,layout='dot')
A.lv <- c("young", "adult", "old")
A.prob <- array(c(0.30, 0.50, 0.20), dim = 3,dimnames = list(A = A.lv))
A.prob
S.lv <- c("M", "F")
S.prob <- array(c(0.6,0.4), dim = 2,dimnames = list(S = S.lv))
S.prob
E.lv <- c("high", "uni")
#P(E|A,S) # dim <- #dim(E)=2, dim(A)=3, dim(S)=2
E.prob <- array(c(0.75, 0.25, 0.72, 0.28, 0.88, 0.12, 0.64,
0.36, 0.70, 0.30, 0.90, 0.10), dim = c(2, 3, 2),
dimnames = list(E = E.lv, A = A.lv, S = S.lv))
#E.prob
ftable(E.prob,row.vars = c(3,2),col.vars = 1)
O.lv <- c("emp", "shelf")
O.prob <- array(c(0.96,0.04,0.92,0.08), dim = c(2,2),dimnames = list(O = O.lv,E=E.lv))
ftable(O.prob,col.vars=1)
R.lv <- c("small", "big")
R.prob <- array(c(0.25,0.75,0.2,0.8), dim = c(2,2),dimnames = list(R = R.lv,E=E.lv))
R.prob
T.lv <- c("car", "train", "other")
T.prob <- array(c(0.48, 0.42, 0.10, 0.56, 0.36, 0.08, 0.58,
0.24, 0.18, 0.70, 0.21, 0.09), dim = c(3, 2, 2),
dimnames = list(T = T.lv, O = O.lv, R = R.lv))
ftable(T.prob,row.vars = c(3,2),col.vars = 1)
cpt  <- list(A=A.prob,S=S.prob,E=E.prob,O=O.prob,R=R.prob,T=T.prob)
bn <- custom.fit(dag,cpt)
bn
class(bn$T$prob)
dimnames(bn$T$prob)
bn$T$prob$car
bn$T$prob['car']
bn$T$prob['car',,]
